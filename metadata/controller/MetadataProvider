{
    "type": "class",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "MetadataProvider",
        "singleton": true,
        "extend": "Ext.util.Observable"
    },
    "designerId": "b3becc8c-fe30-482c-a7a6-6ecd8b708311",
    "cn": [
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "load",
                "designer|params": [
                    "pos",
                    "locale",
                    "cb"
                ],
                "implHandler": [
                    "var mdStore = Ext.getStore(\"metadataStore\");",
                    "",
                    "mdStore.load({",
                    "    params: {",
                    "        poList: pos.join(),",
                    "        locale: locale",
                    "    },",
                    "    callback: function (records, operation, success) {",
                    "        Partner.controller.MetadataProvider.fireEvent('change');",
                    "",
                    "        cb();",
                    "    }",
                    "});"
                ]
            },
            "designerId": "94163354-61c5-44f0-99fe-b548979bda2f"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getLabel",
                "designer|params": [
                    "poName",
                    "propertyName",
                    "locale"
                ],
                "implHandler": [
                    "var mdStore = Ext.getStore(\"metadataStore\");",
                    "",
                    "// PO nachladen falls nicht vorhanden",
                    "if (mdStore.find('name', poName) !== 1) {",
                    "    //Partner.controller.MetadataProvider.load([poName], locale);",
                    "}",
                    "",
                    "// PO finden",
                    "var po = mdStore.findRecord('name', poName);",
                    "",
                    "if (!po) {",
                    "    console.log(poName + ' not found in MetadataProvider');",
                    "    return \"[PO NOT FOUND]\";",
                    "}",
                    "",
                    "// Property holen",
                    "var properties = po.properties();",
                    "",
                    "var property = properties.findRecord('name', propertyName);",
                    "",
                    "if (!property) {",
                    "    console.log('Property ' + propertyName + ' not found in PO ' + poName + ' MetadataProvider');",
                    "    return \"[Property not found]\";",
                    "}",
                    "",
                    "// Texte holen",
                    "var texts = property.propertyTexts();",
                    "",
                    "var text = texts.findRecord('tag', 'label');",
                    "",
                    "return text.get('text');"
                ]
            },
            "designerId": "6c24621a-828e-41d8-8346-37aff70693c4"
        },
        {
            "type": "staticfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "constructor",
                "designer|params": [
                    "params"
                ],
                "implHandler": [
                    "this.addEvents({",
                    "    \"change\" : true",
                    "});",
                    "",
                    "this.callParent(arguments);"
                ]
            },
            "designerId": "29b64bd3-eb97-4d0d-b44d-eaac09836791"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getLabelFromElement",
                "designer|params": [
                    "element"
                ],
                "implHandler": [
                    "",
                    "\tvar propName = this.getClsMetadata(element, element.getCls());",
                    "    if (propName === null) {",
                    "        propName = this.getClsMetadata(element, element.getLabelCls());",
                    "    }",
                    "    if (propName === null) {",
                    "        return \"\";",
                    "    }",
                    "",
                    "    console.log(propName);",
                    "    var parts = propName.split(\".\");",
                    "    var locale = Partner.controller.SettingsProvider.getSetting('locale');",
                    "    var label = this.getLabel(parts[0], parts[1], locale);",
                    "    return label;",
                    ""
                ]
            },
            "designerId": "1938ea3c-ea5d-4002-8ca0-30c1d6bb6b47"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getClsMetadata",
                "designer|params": [
                    "element",
                    "propName"
                ],
                "implHandler": [
                    "    if (propName !== null) {",
                    "\t\tif (propName.constructor === Array) {",
                    "\t\t\tpropName = propName[0];",
                    "        }",
                    "        if (propName.length > 3 && propName.substr(0,3) == \"$M.\") {",
                    "\t\t\treturn propName.substr(3);",
                    "        }",
                    "    }",
                    "    return null;",
                    "",
                    ""
                ]
            },
            "designerId": "74a16b3d-a72b-457e-9ab0-948a3a5e247e"
        }
    ]
}